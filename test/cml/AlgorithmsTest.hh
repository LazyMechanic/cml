#pragma once

#include <gtest/gtest.h>

#include <cml/cml.hh>

using namespace cml;

TEST(Algorithms, modexp)
{
    EXPECT_EQ(modexp(2ull, 2ull, 2ull), 0ull);
    EXPECT_EQ(modexp(2ull, 2ull, 86ull), 4ull);
    EXPECT_EQ(modexp(2ull, 2ull, 3698ull), 4ull);
    EXPECT_EQ(modexp(2ull, 2ull, 159014ull), 4ull);
    EXPECT_EQ(modexp(2ull, 2ull, 6837602ull), 4ull);
    EXPECT_EQ(modexp(2ull, 2ull, 294016886ull), 4ull);
    EXPECT_EQ(modexp(2ull, 2ull, 12642726098ull), 4ull);
    EXPECT_EQ(modexp(2ull, 94ull, 2ull), 0ull);
    EXPECT_EQ(modexp(2ull, 94ull, 86ull), 78ull);
    EXPECT_EQ(modexp(2ull, 94ull, 3698ull), 2314ull);
    EXPECT_EQ(modexp(2ull, 94ull, 159014ull), 124348ull);
    EXPECT_EQ(modexp(2ull, 94ull, 6837602ull), 5530824ull);
    EXPECT_EQ(modexp(2ull, 94ull, 294016886ull), 67069242ull);
    EXPECT_EQ(modexp(2ull, 94ull, 12642726098ull), 3595271874ull);
    EXPECT_EQ(modexp(2ull, 4418ull, 2ull), 0ull);
    EXPECT_EQ(modexp(2ull, 4418ull, 86ull), 84ull);
    EXPECT_EQ(modexp(2ull, 4418ull, 3698ull), 84ull);
    EXPECT_EQ(modexp(2ull, 4418ull, 159014ull), 7480ull);
    EXPECT_EQ(modexp(2ull, 4418ull, 6837602ull), 6209026ull);
    EXPECT_EQ(modexp(2ull, 4418ull, 294016886ull), 26721832ull);
    EXPECT_EQ(modexp(2ull, 4418ull, 12642726098ull), 2966890692ull);
    EXPECT_EQ(modexp(2ull, 207646ull, 2ull), 0ull);
    EXPECT_EQ(modexp(2ull, 207646ull, 86ull), 54ull);
    EXPECT_EQ(modexp(2ull, 207646ull, 3698ull), 656ull);
    EXPECT_EQ(modexp(2ull, 207646ull, 159014ull), 45032ull);
    EXPECT_EQ(modexp(2ull, 207646ull, 6837602ull), 363060ull);
    EXPECT_EQ(modexp(2ull, 207646ull, 294016886ull), 116602294ull);
    EXPECT_EQ(modexp(2ull, 207646ull, 12642726098ull), 3056771154ull);
    EXPECT_EQ(modexp(2ull, 9759362ull, 2ull), 0ull);
    EXPECT_EQ(modexp(2ull, 9759362ull, 86ull), 16ull);
    EXPECT_EQ(modexp(2ull, 9759362ull, 3698ull), 790ull);
    EXPECT_EQ(modexp(2ull, 9759362ull, 159014ull), 19280ull);
    EXPECT_EQ(modexp(2ull, 9759362ull, 6837602ull), 5743784ull);
    EXPECT_EQ(modexp(2ull, 9759362ull, 294016886ull), 108307814ull);
    EXPECT_EQ(modexp(2ull, 9759362ull, 12642726098ull), 8340780622ull);
    EXPECT_EQ(modexp(2ull, 458690014ull, 2ull), 0ull);
    EXPECT_EQ(modexp(2ull, 458690014ull, 86ull), 64ull);
    EXPECT_EQ(modexp(2ull, 458690014ull, 3698ull), 1182ull);
    EXPECT_EQ(modexp(2ull, 458690014ull, 159014ull), 97330ull);
    EXPECT_EQ(modexp(2ull, 458690014ull, 6837602ull), 4549722ull);
    EXPECT_EQ(modexp(2ull, 458690014ull, 294016886ull), 45575334ull);
    EXPECT_EQ(modexp(2ull, 458690014ull, 12642726098ull), 10336166344ull);
    EXPECT_EQ(modexp(2ull, 21558430658ull, 2ull), 0ull);
    EXPECT_EQ(modexp(2ull, 21558430658ull, 86ull), 4ull);
    EXPECT_EQ(modexp(2ull, 21558430658ull, 3698ull), 2756ull);
    EXPECT_EQ(modexp(2ull, 21558430658ull, 159014ull), 143280ull);
    EXPECT_EQ(modexp(2ull, 21558430658ull, 6837602ull), 6662854ull);
    EXPECT_EQ(modexp(2ull, 21558430658ull, 294016886ull), 95551680ull);
    EXPECT_EQ(modexp(2ull, 21558430658ull, 12642726098ull), 9504092032ull);
    EXPECT_EQ(modexp(62ull, 2ull, 2ull), 0ull);
    EXPECT_EQ(modexp(62ull, 2ull, 86ull), 60ull);
    EXPECT_EQ(modexp(62ull, 2ull, 3698ull), 146ull);
    EXPECT_EQ(modexp(62ull, 2ull, 159014ull), 3844ull);
    EXPECT_EQ(modexp(62ull, 2ull, 6837602ull), 3844ull);
    EXPECT_EQ(modexp(62ull, 2ull, 294016886ull), 3844ull);
    EXPECT_EQ(modexp(62ull, 2ull, 12642726098ull), 3844ull);
    EXPECT_EQ(modexp(62ull, 94ull, 2ull), 0ull);
    EXPECT_EQ(modexp(62ull, 94ull, 86ull), 40ull);
    EXPECT_EQ(modexp(62ull, 94ull, 3698ull), 3480ull);
    EXPECT_EQ(modexp(62ull, 94ull, 159014ull), 110722ull);
    EXPECT_EQ(modexp(62ull, 94ull, 6837602ull), 1541848ull);
    EXPECT_EQ(modexp(62ull, 94ull, 294016886ull), 28892256ull);
    EXPECT_EQ(modexp(62ull, 94ull, 12642726098ull), 10319483266ull);
    EXPECT_EQ(modexp(62ull, 4418ull, 2ull), 0ull);
    EXPECT_EQ(modexp(62ull, 4418ull, 86ull), 58ull);
    EXPECT_EQ(modexp(62ull, 4418ull, 3698ull), 3498ull);
    EXPECT_EQ(modexp(62ull, 4418ull, 159014ull), 140324ull);
    EXPECT_EQ(modexp(62ull, 4418ull, 6837602ull), 4433702ull);
    EXPECT_EQ(modexp(62ull, 4418ull, 294016886ull), 189048956ull);
    EXPECT_EQ(modexp(62ull, 4418ull, 12642726098ull), 5187336018ull);
    EXPECT_EQ(modexp(62ull, 207646ull, 2ull), 0ull);
    EXPECT_EQ(modexp(62ull, 207646ull, 86ull), 38ull);
    EXPECT_EQ(modexp(62ull, 207646ull, 3698ull), 124ull);
    EXPECT_EQ(modexp(62ull, 207646ull, 159014ull), 96272ull);
    EXPECT_EQ(modexp(62ull, 207646ull, 6837602ull), 732328ull);
    EXPECT_EQ(modexp(62ull, 207646ull, 294016886ull), 48595542ull);
    EXPECT_EQ(modexp(62ull, 207646ull, 12642726098ull), 12103287868ull);
    EXPECT_EQ(modexp(62ull, 9759362ull, 2ull), 0ull);
    EXPECT_EQ(modexp(62ull, 9759362ull, 86ull), 14ull);
    EXPECT_EQ(modexp(62ull, 9759362ull, 3698ull), 2594ull);
    EXPECT_EQ(modexp(62ull, 9759362ull, 159014ull), 32178ull);
    EXPECT_EQ(modexp(62ull, 9759362ull, 6837602ull), 1781332ull);
    EXPECT_EQ(modexp(62ull, 9759362ull, 294016886ull), 104345362ull);
    EXPECT_EQ(modexp(62ull, 9759362ull, 12642726098ull), 7454767512ull);
    EXPECT_EQ(modexp(62ull, 458690014ull, 2ull), 0ull);
    EXPECT_EQ(modexp(62ull, 458690014ull, 86ull), 66ull);
    EXPECT_EQ(modexp(62ull, 458690014ull, 3698ull), 410ull);
    EXPECT_EQ(modexp(62ull, 458690014ull, 159014ull), 152028ull);
    EXPECT_EQ(modexp(62ull, 458690014ull, 6837602ull), 6353574ull);
    EXPECT_EQ(modexp(62ull, 458690014ull, 294016886ull), 54216788ull);
    EXPECT_EQ(modexp(62ull, 458690014ull, 12642726098ull), 4170453192ull);
    EXPECT_EQ(modexp(62ull, 21558430658ull, 2ull), 0ull);
    EXPECT_EQ(modexp(62ull, 21558430658ull, 86ull), 60ull);
    EXPECT_EQ(modexp(62ull, 21558430658ull, 3698ull), 1694ull);
    EXPECT_EQ(modexp(62ull, 21558430658ull, 159014ull), 53466ull);
    EXPECT_EQ(modexp(62ull, 21558430658ull, 6837602ull), 3869802ull);
    EXPECT_EQ(modexp(62ull, 21558430658ull, 294016886ull), 277373882ull);
    EXPECT_EQ(modexp(62ull, 21558430658ull, 12642726098ull), 9391897348ull);
    EXPECT_EQ(modexp(1922ull, 2ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1922ull, 2ull, 86ull), 40ull);
    EXPECT_EQ(modexp(1922ull, 2ull, 3698ull), 3480ull);
    EXPECT_EQ(modexp(1922ull, 2ull, 159014ull), 36762ull);
    EXPECT_EQ(modexp(1922ull, 2ull, 6837602ull), 3694084ull);
    EXPECT_EQ(modexp(1922ull, 2ull, 294016886ull), 3694084ull);
    EXPECT_EQ(modexp(1922ull, 2ull, 12642726098ull), 3694084ull);
    EXPECT_EQ(modexp(1922ull, 94ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1922ull, 94ull, 86ull), 58ull);
    EXPECT_EQ(modexp(1922ull, 94ull, 3698ull), 3498ull);
    EXPECT_EQ(modexp(1922ull, 94ull, 159014ull), 29384ull);
    EXPECT_EQ(modexp(1922ull, 94ull, 6837602ull), 506426ull);
    EXPECT_EQ(modexp(1922ull, 94ull, 294016886ull), 280848108ull);
    EXPECT_EQ(modexp(1922ull, 94ull, 12642726098ull), 3221016968ull);
    EXPECT_EQ(modexp(1922ull, 4418ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1922ull, 4418ull, 86ull), 38ull);
    EXPECT_EQ(modexp(1922ull, 4418ull, 3698ull), 124ull);
    EXPECT_EQ(modexp(1922ull, 4418ull, 159014ull), 85178ull);
    EXPECT_EQ(modexp(1922ull, 4418ull, 6837602ull), 3583486ull);
    EXPECT_EQ(modexp(1922ull, 4418ull, 294016886ull), 71959506ull);
    EXPECT_EQ(modexp(1922ull, 4418ull, 12642726098ull), 3306145252ull);
    EXPECT_EQ(modexp(1922ull, 207646ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1922ull, 207646ull, 86ull), 14ull);
    EXPECT_EQ(modexp(1922ull, 207646ull, 3698ull), 2594ull);
    EXPECT_EQ(modexp(1922ull, 207646ull, 159014ull), 124628ull);
    EXPECT_EQ(modexp(1922ull, 207646ull, 6837602ull), 3304908ull);
    EXPECT_EQ(modexp(1922ull, 207646ull, 294016886ull), 187920162ull);
    EXPECT_EQ(modexp(1922ull, 207646ull, 12642726098ull), 11948595602ull);
    EXPECT_EQ(modexp(1922ull, 9759362ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1922ull, 9759362ull, 86ull), 66ull);
    EXPECT_EQ(modexp(1922ull, 9759362ull, 3698ull), 410ull);
    EXPECT_EQ(modexp(1922ull, 9759362ull, 159014ull), 78068ull);
    EXPECT_EQ(modexp(1922ull, 9759362ull, 6837602ull), 2304264ull);
    EXPECT_EQ(modexp(1922ull, 9759362ull, 294016886ull), 186919518ull);
    EXPECT_EQ(modexp(1922ull, 9759362ull, 12642726098ull), 10183493642ull);
    EXPECT_EQ(modexp(1922ull, 458690014ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1922ull, 458690014ull, 86ull), 60ull);
    EXPECT_EQ(modexp(1922ull, 458690014ull, 3698ull), 1694ull);
    EXPECT_EQ(modexp(1922ull, 458690014ull, 159014ull), 145916ull);
    EXPECT_EQ(modexp(1922ull, 458690014ull, 6837602ull), 2690140ull);
    EXPECT_EQ(modexp(1922ull, 458690014ull, 294016886ull), 98416568ull);
    EXPECT_EQ(modexp(1922ull, 458690014ull, 12642726098ull), 8330889376ull);
    EXPECT_EQ(modexp(1922ull, 21558430658ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1922ull, 21558430658ull, 86ull), 40ull);
    EXPECT_EQ(modexp(1922ull, 21558430658ull, 3698ull), 212ull);
    EXPECT_EQ(modexp(1922ull, 21558430658ull, 159014ull), 3910ull);
    EXPECT_EQ(modexp(1922ull, 21558430658ull, 6837602ull), 5092358ull);
    EXPECT_EQ(modexp(1922ull, 21558430658ull, 294016886ull), 73468378ull);
    EXPECT_EQ(modexp(1922ull, 21558430658ull, 12642726098ull), 7717907414ull);
    EXPECT_EQ(modexp(59582ull, 2ull, 2ull), 0ull);
    EXPECT_EQ(modexp(59582ull, 2ull, 86ull), 84ull);
    EXPECT_EQ(modexp(59582ull, 2ull, 3698ull), 1288ull);
    EXPECT_EQ(modexp(59582ull, 2ull, 159014ull), 27174ull);
    EXPECT_EQ(modexp(59582ull, 2ull, 6837602ull), 1299286ull);
    EXPECT_EQ(modexp(59582ull, 2ull, 294016886ull), 21812092ull);
    EXPECT_EQ(modexp(59582ull, 2ull, 12642726098ull), 3550014724ull);
    EXPECT_EQ(modexp(59582ull, 94ull, 2ull), 0ull);
    EXPECT_EQ(modexp(59582ull, 94ull, 86ull), 54ull);
    EXPECT_EQ(modexp(59582ull, 94ull, 3698ull), 54ull);
    EXPECT_EQ(modexp(59582ull, 94ull, 159014ull), 40732ull);
    EXPECT_EQ(modexp(59582ull, 94ull, 6837602ull), 5765236ull);
    EXPECT_EQ(modexp(59582ull, 94ull, 294016886ull), 53628450ull);
    EXPECT_EQ(modexp(59582ull, 94ull, 12642726098ull), 8286101258ull);
    EXPECT_EQ(modexp(59582ull, 4418ull, 2ull), 0ull);
    EXPECT_EQ(modexp(59582ull, 4418ull, 86ull), 16ull);
    EXPECT_EQ(modexp(59582ull, 4418ull, 3698ull), 1994ull);
    EXPECT_EQ(modexp(59582ull, 4418ull, 159014ull), 109236ull);
    EXPECT_EQ(modexp(59582ull, 4418ull, 6837602ull), 1540362ull);
    EXPECT_EQ(modexp(59582ull, 4418ull, 294016886ull), 138292402ull);
    EXPECT_EQ(modexp(59582ull, 4418ull, 12642726098ull), 6900680780ull);
    EXPECT_EQ(modexp(59582ull, 207646ull, 2ull), 0ull);
    EXPECT_EQ(modexp(59582ull, 207646ull, 86ull), 64ull);
    EXPECT_EQ(modexp(59582ull, 207646ull, 3698ull), 1956ull);
    EXPECT_EQ(modexp(59582ull, 207646ull, 159014ull), 142480ull);
    EXPECT_EQ(modexp(59582ull, 207646ull, 6837602ull), 3481774ull);
    EXPECT_EQ(modexp(59582ull, 207646ull, 294016886ull), 249635446ull);
    EXPECT_EQ(modexp(59582ull, 207646ull, 12642726098ull), 7306040710ull);
    EXPECT_EQ(modexp(59582ull, 9759362ull, 2ull), 0ull);
    EXPECT_EQ(modexp(59582ull, 9759362ull, 86ull), 4ull);
    EXPECT_EQ(modexp(59582ull, 9759362ull, 3698ull), 176ull);
    EXPECT_EQ(modexp(59582ull, 9759362ull, 159014ull), 44552ull);
    EXPECT_EQ(modexp(59582ull, 9759362ull, 6837602ull), 839622ull);
    EXPECT_EQ(modexp(59582ull, 9759362ull, 294016886ull), 158104468ull);
    EXPECT_EQ(modexp(59582ull, 9759362ull, 12642726098ull), 158104468ull);
    EXPECT_EQ(modexp(59582ull, 458690014ull, 2ull), 0ull);
    EXPECT_EQ(modexp(59582ull, 458690014ull, 86ull), 78ull);
    EXPECT_EQ(modexp(59582ull, 458690014ull, 3698ull), 938ull);
    EXPECT_EQ(modexp(59582ull, 458690014ull, 159014ull), 63804ull);
    EXPECT_EQ(modexp(59582ull, 458690014ull, 6837602ull), 3085070ull);
    EXPECT_EQ(modexp(59582ull, 458690014ull, 294016886ull), 221888334ull);
    EXPECT_EQ(modexp(59582ull, 458690014ull, 12642726098ull), 6690259826ull);
    EXPECT_EQ(modexp(59582ull, 21558430658ull, 2ull), 0ull);
    EXPECT_EQ(modexp(59582ull, 21558430658ull, 86ull), 84ull);
    EXPECT_EQ(modexp(59582ull, 21558430658ull, 3698ull), 2406ull);
    EXPECT_EQ(modexp(59582ull, 21558430658ull, 159014ull), 31990ull);
    EXPECT_EQ(modexp(59582ull, 21558430658ull, 6837602ull), 1940158ull);
    EXPECT_EQ(modexp(59582ull, 21558430658ull, 294016886ull), 275444238ull);
    EXPECT_EQ(modexp(59582ull, 21558430658ull, 12642726098ull), 6743815730ull);
    EXPECT_EQ(modexp(1847042ull, 2ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1847042ull, 2ull, 86ull), 56ull);
    EXPECT_EQ(modexp(1847042ull, 2ull, 3698ull), 2636ull);
    EXPECT_EQ(modexp(1847042ull, 2ull, 159014ull), 35918ull);
    EXPECT_EQ(modexp(1847042ull, 2ull, 6837602ull), 4170282ull);
    EXPECT_EQ(modexp(1847042ull, 2ull, 294016886ull), 86221506ull);
    EXPECT_EQ(modexp(1847042ull, 2ull, 12642726098ull), 10670829402ull);
    EXPECT_EQ(modexp(1847042ull, 94ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1847042ull, 94ull, 86ull), 74ull);
    EXPECT_EQ(modexp(1847042ull, 94ull, 3698ull), 762ull);
    EXPECT_EQ(modexp(1847042ull, 94ull, 159014ull), 41440ull);
    EXPECT_EQ(modexp(1847042ull, 94ull, 6837602ull), 4970874ull);
    EXPECT_EQ(modexp(1847042ull, 94ull, 294016886ull), 39158884ull);
    EXPECT_EQ(modexp(1847042ull, 94ull, 12642726098ull), 7683597920ull);
    EXPECT_EQ(modexp(1847042ull, 4418ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1847042ull, 4418ull, 86ull), 52ull);
    EXPECT_EQ(modexp(1847042ull, 4418ull, 3698ull), 1944ull);
    EXPECT_EQ(modexp(1847042ull, 4418ull, 159014ull), 57414ull);
    EXPECT_EQ(modexp(1847042ull, 4418ull, 6837602ull), 57414ull);
    EXPECT_EQ(modexp(1847042ull, 4418ull, 294016886ull), 116296648ull);
    EXPECT_EQ(modexp(1847042ull, 4418ull, 12642726098ull), 10994921430ull);
    EXPECT_EQ(modexp(1847042ull, 207646ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1847042ull, 207646ull, 86ull), 10ull);
    EXPECT_EQ(modexp(1847042ull, 207646ull, 3698ull), 956ull);
    EXPECT_EQ(modexp(1847042ull, 207646ull, 159014ull), 45332ull);
    EXPECT_EQ(modexp(1847042ull, 207646ull, 6837602ull), 2271528ull);
    EXPECT_EQ(modexp(1847042ull, 207646ull, 294016886ull), 152698772ull);
    EXPECT_EQ(modexp(1847042ull, 207646ull, 12642726098ull), 4268935176ull);
    EXPECT_EQ(modexp(1847042ull, 9759362ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1847042ull, 9759362ull, 86ull), 68ull);
    EXPECT_EQ(modexp(1847042ull, 9759362ull, 3698ull), 2132ull);
    EXPECT_EQ(modexp(1847042ull, 9759362ull, 159014ull), 131562ull);
    EXPECT_EQ(modexp(1847042ull, 9759362ull, 6837602ull), 4583954ull);
    EXPECT_EQ(modexp(1847042ull, 9759362ull, 294016886ull), 4583954ull);
    EXPECT_EQ(modexp(1847042ull, 9759362ull, 12642726098ull), 6472955446ull);
    EXPECT_EQ(modexp(1847042ull, 458690014ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1847042ull, 458690014ull, 86ull), 24ull);
    EXPECT_EQ(modexp(1847042ull, 458690014ull, 3698ull), 1314ull);
    EXPECT_EQ(modexp(1847042ull, 458690014ull, 159014ull), 127046ull);
    EXPECT_EQ(modexp(1847042ull, 458690014ull, 6837602ull), 604088ull);
    EXPECT_EQ(modexp(1847042ull, 458690014ull, 294016886ull), 246757760ull);
    EXPECT_EQ(modexp(1847042ull, 458690014ull, 12642726098ull), 246757760ull);
    EXPECT_EQ(modexp(1847042ull, 21558430658ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1847042ull, 21558430658ull, 86ull), 56ull);
    EXPECT_EQ(modexp(1847042ull, 21558430658ull, 3698ull), 2292ull);
    EXPECT_EQ(modexp(1847042ull, 21558430658ull, 159014ull), 39272ull);
    EXPECT_EQ(modexp(1847042ull, 21558430658ull, 6837602ull), 5922790ull);
    EXPECT_EQ(modexp(1847042ull, 21558430658ull, 294016886ull), 149512432ull);
    EXPECT_EQ(modexp(1847042ull, 21558430658ull, 12642726098ull), 10734120328ull);
    EXPECT_EQ(modexp(57258302ull, 2ull, 2ull), 0ull);
    EXPECT_EQ(modexp(57258302ull, 2ull, 86ull), 66ull);
    EXPECT_EQ(modexp(57258302ull, 2ull, 3698ull), 66ull);
    EXPECT_EQ(modexp(57258302ull, 2ull, 159014ull), 11160ull);
    EXPECT_EQ(modexp(57258302ull, 2ull, 6837602ull), 806230ull);
    EXPECT_EQ(modexp(57258302ull, 2ull, 294016886ull), 240122300ull);
    EXPECT_EQ(modexp(57258302ull, 2ull, 12642726098ull), 1416189844ull);
    EXPECT_EQ(modexp(57258302ull, 94ull, 2ull), 0ull);
    EXPECT_EQ(modexp(57258302ull, 94ull, 86ull), 60ull);
    EXPECT_EQ(modexp(57258302ull, 94ull, 3698ull), 2124ull);
    EXPECT_EQ(modexp(57258302ull, 94ull, 159014ull), 124158ull);
    EXPECT_EQ(modexp(57258302ull, 94ull, 6837602ull), 124158ull);
    EXPECT_EQ(modexp(57258302ull, 94ull, 294016886ull), 34312168ull);
    EXPECT_EQ(modexp(57258302ull, 94ull, 12642726098ull), 9442852520ull);
    EXPECT_EQ(modexp(57258302ull, 4418ull, 2ull), 0ull);
    EXPECT_EQ(modexp(57258302ull, 4418ull, 86ull), 40ull);
    EXPECT_EQ(modexp(57258302ull, 4418ull, 3698ull), 126ull);
    EXPECT_EQ(modexp(57258302ull, 4418ull, 159014ull), 14918ull);
    EXPECT_EQ(modexp(57258302ull, 4418ull, 6837602ull), 5739422ull);
    EXPECT_EQ(modexp(57258302ull, 4418ull, 294016886ull), 19414626ull);
    EXPECT_EQ(modexp(57258302ull, 4418ull, 12642726098ull), 7369836776ull);
    EXPECT_EQ(modexp(57258302ull, 207646ull, 2ull), 0ull);
    EXPECT_EQ(modexp(57258302ull, 207646ull, 86ull), 58ull);
    EXPECT_EQ(modexp(57258302ull, 207646ull, 3698ull), 316ull);
    EXPECT_EQ(modexp(57258302ull, 207646ull, 159014ull), 100162ull);
    EXPECT_EQ(modexp(57258302ull, 207646ull, 6837602ull), 5824666ull);
    EXPECT_EQ(modexp(57258302ull, 207646ull, 294016886ull), 46850278ull);
    EXPECT_EQ(modexp(57258302ull, 207646ull, 12642726098ull), 2104968480ull);
    EXPECT_EQ(modexp(57258302ull, 9759362ull, 2ull), 0ull);
    EXPECT_EQ(modexp(57258302ull, 9759362ull, 86ull), 38ull);
    EXPECT_EQ(modexp(57258302ull, 9759362ull, 3698ull), 3134ull);
    EXPECT_EQ(modexp(57258302ull, 9759362ull, 159014ull), 51208ull);
    EXPECT_EQ(modexp(57258302ull, 9759362ull, 6837602ull), 3231488ull);
    EXPECT_EQ(modexp(57258302ull, 9759362ull, 294016886ull), 222034752ull);
    EXPECT_EQ(modexp(57258302ull, 9759362ull, 12642726098ull), 9630575104ull);
    EXPECT_EQ(modexp(57258302ull, 458690014ull, 2ull), 0ull);
    EXPECT_EQ(modexp(57258302ull, 458690014ull, 86ull), 14ull);
    EXPECT_EQ(modexp(57258302ull, 458690014ull, 3698ull), 2164ull);
    EXPECT_EQ(modexp(57258302ull, 458690014ull, 159014ull), 31748ull);
    EXPECT_EQ(modexp(57258302ull, 458690014ull, 6837602ull), 5597238ull);
    EXPECT_EQ(modexp(57258302ull, 458690014ull, 294016886ull), 224400502ull);
    EXPECT_EQ(modexp(57258302ull, 458690014ull, 12642726098ull), 7574822652ull);
    EXPECT_EQ(modexp(57258302ull, 21558430658ull, 2ull), 0ull);
    EXPECT_EQ(modexp(57258302ull, 21558430658ull, 86ull), 66ull);
    EXPECT_EQ(modexp(57258302ull, 21558430658ull, 3698ull), 754ull);
    EXPECT_EQ(modexp(57258302ull, 21558430658ull, 159014ull), 48828ull);
    EXPECT_EQ(modexp(57258302ull, 21558430658ull, 6837602ull), 3229108ull);
    EXPECT_EQ(modexp(57258302ull, 21558430658ull, 294016886ull), 290408392ull);
    EXPECT_EQ(modexp(57258302ull, 21558430658ull, 12642726098ull), 11463050060ull);
    EXPECT_EQ(modexp(1775007362ull, 2ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1775007362ull, 2ull, 86ull), 44ull);
    EXPECT_EQ(modexp(1775007362ull, 2ull, 3698ull), 560ull);
    EXPECT_EQ(modexp(1775007362ull, 2ull, 159014ull), 70822ull);
    EXPECT_EQ(modexp(1775007362ull, 2ull, 6837602ull), 2138004ull);
    EXPECT_EQ(modexp(1775007362ull, 2ull, 294016886ull), 248291676ull);
    EXPECT_EQ(modexp(1775007362ull, 2ull, 12642726098ull), 8186747598ull);
    EXPECT_EQ(modexp(1775007362ull, 94ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1775007362ull, 94ull, 86ull), 44ull);
    EXPECT_EQ(modexp(1775007362ull, 94ull, 3698ull), 388ull);
    EXPECT_EQ(modexp(1775007362ull, 94ull, 159014ull), 115026ull);
    EXPECT_EQ(modexp(1775007362ull, 94ull, 6837602ull), 4885446ull);
    EXPECT_EQ(modexp(1775007362ull, 94ull, 294016886ull), 196338302ull);
    EXPECT_EQ(modexp(1775007362ull, 94ull, 12642726098ull), 10780946198ull);
    EXPECT_EQ(modexp(1775007362ull, 4418ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1775007362ull, 4418ull, 86ull), 44ull);
    EXPECT_EQ(modexp(1775007362ull, 4418ull, 3698ull), 3398ull);
    EXPECT_EQ(modexp(1775007362ull, 4418ull, 159014ull), 103244ull);
    EXPECT_EQ(modexp(1775007362ull, 4418ull, 6837602ull), 3601552ull);
    EXPECT_EQ(modexp(1775007362ull, 4418ull, 294016886ull), 222404816ull);
    EXPECT_EQ(modexp(1775007362ull, 4418ull, 12642726098ull), 516421702ull);
    EXPECT_EQ(modexp(1775007362ull, 207646ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1775007362ull, 207646ull, 86ull), 44ull);
    EXPECT_EQ(modexp(1775007362ull, 207646ull, 3698ull), 646ull);
    EXPECT_EQ(modexp(1775007362ull, 207646ull, 159014ull), 148566ull);
    EXPECT_EQ(modexp(1775007362ull, 207646ull, 6837602ull), 6350112ull);
    EXPECT_EQ(modexp(1775007362ull, 207646ull, 294016886ull), 245666182ull);
    EXPECT_EQ(modexp(1775007362ull, 207646ull, 12642726098ull), 2009767498ull);
    EXPECT_EQ(modexp(1775007362ull, 9759362ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1775007362ull, 9759362ull, 86ull), 44ull);
    EXPECT_EQ(modexp(1775007362ull, 9759362ull, 3698ull), 732ull);
    EXPECT_EQ(modexp(1775007362ull, 9759362ull, 159014ull), 96880ull);
    EXPECT_EQ(modexp(1775007362ull, 9759362ull, 6837602ull), 2323076ull);
    EXPECT_EQ(modexp(1775007362ull, 9759362ull, 294016886ull), 186938330ull);
    EXPECT_EQ(modexp(1775007362ull, 9759362ull, 12642726098ull), 2245056532ull);
    EXPECT_EQ(modexp(1775007362ull, 458690014ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1775007362ull, 458690014ull, 86ull), 44ull);
    EXPECT_EQ(modexp(1775007362ull, 458690014ull, 3698ull), 1076ull);
    EXPECT_EQ(modexp(1775007362ull, 458690014ull, 159014ull), 126808ull);
    EXPECT_EQ(modexp(1775007362ull, 458690014ull, 6837602ull), 5533284ull);
    EXPECT_EQ(modexp(1775007362ull, 458690014ull, 294016886ull), 258524558ull);
    EXPECT_EQ(modexp(1775007362ull, 458690014ull, 12642726098ull), 3198693418ull);
    EXPECT_EQ(modexp(1775007362ull, 21558430658ull, 2ull), 0ull);
    EXPECT_EQ(modexp(1775007362ull, 21558430658ull, 86ull), 44ull);
    EXPECT_EQ(modexp(1775007362ull, 21558430658ull, 3698ull), 2452ull);
    EXPECT_EQ(modexp(1775007362ull, 21558430658ull, 159014ull), 13546ull);
    EXPECT_EQ(modexp(1775007362ull, 21558430658ull, 6837602ull), 1285658ull);
    EXPECT_EQ(modexp(1775007362ull, 21558430658ull, 294016886ull), 206413718ull);
    EXPECT_EQ(modexp(1775007362ull, 21558430658ull, 12642726098ull), 11379055386ull);
}

TEST(Algorithms, gcd)
{
    EXPECT_EQ(gcd(1ull, 1ull), 1ull);
    EXPECT_EQ(gcd(1ull, 7ull), 1ull);
    EXPECT_EQ(gcd(1ull, 49ull), 1ull);
    EXPECT_EQ(gcd(1ull, 343ull), 1ull);
    EXPECT_EQ(gcd(1ull, 2401ull), 1ull);
    EXPECT_EQ(gcd(1ull, 16807ull), 1ull);
    EXPECT_EQ(gcd(1ull, 117649ull), 1ull);
    EXPECT_EQ(gcd(1ull, 823543ull), 1ull);
    EXPECT_EQ(gcd(1ull, 5764801ull), 1ull);
    EXPECT_EQ(gcd(1ull, 40353607ull), 1ull);
    EXPECT_EQ(gcd(1ull, 282475249ull), 1ull);
    EXPECT_EQ(gcd(1ull, 1977326743ull), 1ull);
    EXPECT_EQ(gcd(1ull, 13841287201ull), 1ull);
    EXPECT_EQ(gcd(1ull, 96889010407ull), 1ull);
    EXPECT_EQ(gcd(1ull, 678223072849ull), 1ull);
    EXPECT_EQ(gcd(7ull, 1ull), 1ull);
    EXPECT_EQ(gcd(7ull, 7ull), 7ull);
    EXPECT_EQ(gcd(7ull, 49ull), 7ull);
    EXPECT_EQ(gcd(7ull, 343ull), 7ull);
    EXPECT_EQ(gcd(7ull, 2401ull), 7ull);
    EXPECT_EQ(gcd(7ull, 16807ull), 7ull);
    EXPECT_EQ(gcd(7ull, 117649ull), 7ull);
    EXPECT_EQ(gcd(7ull, 823543ull), 7ull);
    EXPECT_EQ(gcd(7ull, 5764801ull), 7ull);
    EXPECT_EQ(gcd(7ull, 40353607ull), 7ull);
    EXPECT_EQ(gcd(7ull, 282475249ull), 7ull);
    EXPECT_EQ(gcd(7ull, 1977326743ull), 7ull);
    EXPECT_EQ(gcd(7ull, 13841287201ull), 7ull);
    EXPECT_EQ(gcd(7ull, 96889010407ull), 7ull);
    EXPECT_EQ(gcd(7ull, 678223072849ull), 7ull);
    EXPECT_EQ(gcd(49ull, 1ull), 1ull);
    EXPECT_EQ(gcd(49ull, 7ull), 7ull);
    EXPECT_EQ(gcd(49ull, 49ull), 49ull);
    EXPECT_EQ(gcd(49ull, 343ull), 49ull);
    EXPECT_EQ(gcd(49ull, 2401ull), 49ull);
    EXPECT_EQ(gcd(49ull, 16807ull), 49ull);
    EXPECT_EQ(gcd(49ull, 117649ull), 49ull);
    EXPECT_EQ(gcd(49ull, 823543ull), 49ull);
    EXPECT_EQ(gcd(49ull, 5764801ull), 49ull);
    EXPECT_EQ(gcd(49ull, 40353607ull), 49ull);
    EXPECT_EQ(gcd(49ull, 282475249ull), 49ull);
    EXPECT_EQ(gcd(49ull, 1977326743ull), 49ull);
    EXPECT_EQ(gcd(49ull, 13841287201ull), 49ull);
    EXPECT_EQ(gcd(49ull, 96889010407ull), 49ull);
    EXPECT_EQ(gcd(49ull, 678223072849ull), 49ull);
    EXPECT_EQ(gcd(343ull, 1ull), 1ull);
    EXPECT_EQ(gcd(343ull, 7ull), 7ull);
    EXPECT_EQ(gcd(343ull, 49ull), 49ull);
    EXPECT_EQ(gcd(343ull, 343ull), 343ull);
    EXPECT_EQ(gcd(343ull, 2401ull), 343ull);
    EXPECT_EQ(gcd(343ull, 16807ull), 343ull);
    EXPECT_EQ(gcd(343ull, 117649ull), 343ull);
    EXPECT_EQ(gcd(343ull, 823543ull), 343ull);
    EXPECT_EQ(gcd(343ull, 5764801ull), 343ull);
    EXPECT_EQ(gcd(343ull, 40353607ull), 343ull);
    EXPECT_EQ(gcd(343ull, 282475249ull), 343ull);
    EXPECT_EQ(gcd(343ull, 1977326743ull), 343ull);
    EXPECT_EQ(gcd(343ull, 13841287201ull), 343ull);
    EXPECT_EQ(gcd(343ull, 96889010407ull), 343ull);
    EXPECT_EQ(gcd(343ull, 678223072849ull), 343ull);
    EXPECT_EQ(gcd(2401ull, 1ull), 1ull);
    EXPECT_EQ(gcd(2401ull, 7ull), 7ull);
    EXPECT_EQ(gcd(2401ull, 49ull), 49ull);
    EXPECT_EQ(gcd(2401ull, 343ull), 343ull);
    EXPECT_EQ(gcd(2401ull, 2401ull), 2401ull);
    EXPECT_EQ(gcd(2401ull, 16807ull), 2401ull);
    EXPECT_EQ(gcd(2401ull, 117649ull), 2401ull);
    EXPECT_EQ(gcd(2401ull, 823543ull), 2401ull);
    EXPECT_EQ(gcd(2401ull, 5764801ull), 2401ull);
    EXPECT_EQ(gcd(2401ull, 40353607ull), 2401ull);
    EXPECT_EQ(gcd(2401ull, 282475249ull), 2401ull);
    EXPECT_EQ(gcd(2401ull, 1977326743ull), 2401ull);
    EXPECT_EQ(gcd(2401ull, 13841287201ull), 2401ull);
    EXPECT_EQ(gcd(2401ull, 96889010407ull), 2401ull);
    EXPECT_EQ(gcd(2401ull, 678223072849ull), 2401ull);
    EXPECT_EQ(gcd(16807ull, 1ull), 1ull);
    EXPECT_EQ(gcd(16807ull, 7ull), 7ull);
    EXPECT_EQ(gcd(16807ull, 49ull), 49ull);
    EXPECT_EQ(gcd(16807ull, 343ull), 343ull);
    EXPECT_EQ(gcd(16807ull, 2401ull), 2401ull);
    EXPECT_EQ(gcd(16807ull, 16807ull), 16807ull);
    EXPECT_EQ(gcd(16807ull, 117649ull), 16807ull);
    EXPECT_EQ(gcd(16807ull, 823543ull), 16807ull);
    EXPECT_EQ(gcd(16807ull, 5764801ull), 16807ull);
    EXPECT_EQ(gcd(16807ull, 40353607ull), 16807ull);
    EXPECT_EQ(gcd(16807ull, 282475249ull), 16807ull);
    EXPECT_EQ(gcd(16807ull, 1977326743ull), 16807ull);
    EXPECT_EQ(gcd(16807ull, 13841287201ull), 16807ull);
    EXPECT_EQ(gcd(16807ull, 96889010407ull), 16807ull);
    EXPECT_EQ(gcd(16807ull, 678223072849ull), 16807ull);
    EXPECT_EQ(gcd(117649ull, 1ull), 1ull);
    EXPECT_EQ(gcd(117649ull, 7ull), 7ull);
    EXPECT_EQ(gcd(117649ull, 49ull), 49ull);
    EXPECT_EQ(gcd(117649ull, 343ull), 343ull);
    EXPECT_EQ(gcd(117649ull, 2401ull), 2401ull);
    EXPECT_EQ(gcd(117649ull, 16807ull), 16807ull);
    EXPECT_EQ(gcd(117649ull, 117649ull), 117649ull);
    EXPECT_EQ(gcd(117649ull, 823543ull), 117649ull);
    EXPECT_EQ(gcd(117649ull, 5764801ull), 117649ull);
    EXPECT_EQ(gcd(117649ull, 40353607ull), 117649ull);
    EXPECT_EQ(gcd(117649ull, 282475249ull), 117649ull);
    EXPECT_EQ(gcd(117649ull, 1977326743ull), 117649ull);
    EXPECT_EQ(gcd(117649ull, 13841287201ull), 117649ull);
    EXPECT_EQ(gcd(117649ull, 96889010407ull), 117649ull);
    EXPECT_EQ(gcd(117649ull, 678223072849ull), 117649ull);
    EXPECT_EQ(gcd(823543ull, 1ull), 1ull);
    EXPECT_EQ(gcd(823543ull, 7ull), 7ull);
    EXPECT_EQ(gcd(823543ull, 49ull), 49ull);
    EXPECT_EQ(gcd(823543ull, 343ull), 343ull);
    EXPECT_EQ(gcd(823543ull, 2401ull), 2401ull);
    EXPECT_EQ(gcd(823543ull, 16807ull), 16807ull);
    EXPECT_EQ(gcd(823543ull, 117649ull), 117649ull);
    EXPECT_EQ(gcd(823543ull, 823543ull), 823543ull);
    EXPECT_EQ(gcd(823543ull, 5764801ull), 823543ull);
    EXPECT_EQ(gcd(823543ull, 40353607ull), 823543ull);
    EXPECT_EQ(gcd(823543ull, 282475249ull), 823543ull);
    EXPECT_EQ(gcd(823543ull, 1977326743ull), 823543ull);
    EXPECT_EQ(gcd(823543ull, 13841287201ull), 823543ull);
    EXPECT_EQ(gcd(823543ull, 96889010407ull), 823543ull);
    EXPECT_EQ(gcd(823543ull, 678223072849ull), 823543ull);
    EXPECT_EQ(gcd(5764801ull, 1ull), 1ull);
    EXPECT_EQ(gcd(5764801ull, 7ull), 7ull);
    EXPECT_EQ(gcd(5764801ull, 49ull), 49ull);
    EXPECT_EQ(gcd(5764801ull, 343ull), 343ull);
    EXPECT_EQ(gcd(5764801ull, 2401ull), 2401ull);
    EXPECT_EQ(gcd(5764801ull, 16807ull), 16807ull);
    EXPECT_EQ(gcd(5764801ull, 117649ull), 117649ull);
    EXPECT_EQ(gcd(5764801ull, 823543ull), 823543ull);
    EXPECT_EQ(gcd(5764801ull, 5764801ull), 5764801ull);
    EXPECT_EQ(gcd(5764801ull, 40353607ull), 5764801ull);
    EXPECT_EQ(gcd(5764801ull, 282475249ull), 5764801ull);
    EXPECT_EQ(gcd(5764801ull, 1977326743ull), 5764801ull);
    EXPECT_EQ(gcd(5764801ull, 13841287201ull), 5764801ull);
    EXPECT_EQ(gcd(5764801ull, 96889010407ull), 5764801ull);
    EXPECT_EQ(gcd(5764801ull, 678223072849ull), 5764801ull);
    EXPECT_EQ(gcd(40353607ull, 1ull), 1ull);
    EXPECT_EQ(gcd(40353607ull, 7ull), 7ull);
    EXPECT_EQ(gcd(40353607ull, 49ull), 49ull);
    EXPECT_EQ(gcd(40353607ull, 343ull), 343ull);
    EXPECT_EQ(gcd(40353607ull, 2401ull), 2401ull);
    EXPECT_EQ(gcd(40353607ull, 16807ull), 16807ull);
    EXPECT_EQ(gcd(40353607ull, 117649ull), 117649ull);
    EXPECT_EQ(gcd(40353607ull, 823543ull), 823543ull);
    EXPECT_EQ(gcd(40353607ull, 5764801ull), 5764801ull);
    EXPECT_EQ(gcd(40353607ull, 40353607ull), 40353607ull);
    EXPECT_EQ(gcd(40353607ull, 282475249ull), 40353607ull);
    EXPECT_EQ(gcd(40353607ull, 1977326743ull), 40353607ull);
    EXPECT_EQ(gcd(40353607ull, 13841287201ull), 40353607ull);
    EXPECT_EQ(gcd(40353607ull, 96889010407ull), 40353607ull);
    EXPECT_EQ(gcd(40353607ull, 678223072849ull), 40353607ull);
    EXPECT_EQ(gcd(282475249ull, 1ull), 1ull);
    EXPECT_EQ(gcd(282475249ull, 7ull), 7ull);
    EXPECT_EQ(gcd(282475249ull, 49ull), 49ull);
    EXPECT_EQ(gcd(282475249ull, 343ull), 343ull);
    EXPECT_EQ(gcd(282475249ull, 2401ull), 2401ull);
    EXPECT_EQ(gcd(282475249ull, 16807ull), 16807ull);
    EXPECT_EQ(gcd(282475249ull, 117649ull), 117649ull);
    EXPECT_EQ(gcd(282475249ull, 823543ull), 823543ull);
    EXPECT_EQ(gcd(282475249ull, 5764801ull), 5764801ull);
    EXPECT_EQ(gcd(282475249ull, 40353607ull), 40353607ull);
    EXPECT_EQ(gcd(282475249ull, 282475249ull), 282475249ull);
    EXPECT_EQ(gcd(282475249ull, 1977326743ull), 282475249ull);
    EXPECT_EQ(gcd(282475249ull, 13841287201ull), 282475249ull);
    EXPECT_EQ(gcd(282475249ull, 96889010407ull), 282475249ull);
    EXPECT_EQ(gcd(282475249ull, 678223072849ull), 282475249ull);
    EXPECT_EQ(gcd(1977326743ull, 1ull), 1ull);
    EXPECT_EQ(gcd(1977326743ull, 7ull), 7ull);
    EXPECT_EQ(gcd(1977326743ull, 49ull), 49ull);
    EXPECT_EQ(gcd(1977326743ull, 343ull), 343ull);
    EXPECT_EQ(gcd(1977326743ull, 2401ull), 2401ull);
    EXPECT_EQ(gcd(1977326743ull, 16807ull), 16807ull);
    EXPECT_EQ(gcd(1977326743ull, 117649ull), 117649ull);
    EXPECT_EQ(gcd(1977326743ull, 823543ull), 823543ull);
    EXPECT_EQ(gcd(1977326743ull, 5764801ull), 5764801ull);
    EXPECT_EQ(gcd(1977326743ull, 40353607ull), 40353607ull);
    EXPECT_EQ(gcd(1977326743ull, 282475249ull), 282475249ull);
    EXPECT_EQ(gcd(1977326743ull, 1977326743ull), 1977326743ull);
    EXPECT_EQ(gcd(1977326743ull, 13841287201ull), 1977326743ull);
    EXPECT_EQ(gcd(1977326743ull, 96889010407ull), 1977326743ull);
    EXPECT_EQ(gcd(1977326743ull, 678223072849ull), 1977326743ull);
    EXPECT_EQ(gcd(13841287201ull, 1ull), 1ull);
    EXPECT_EQ(gcd(13841287201ull, 7ull), 7ull);
    EXPECT_EQ(gcd(13841287201ull, 49ull), 49ull);
    EXPECT_EQ(gcd(13841287201ull, 343ull), 343ull);
    EXPECT_EQ(gcd(13841287201ull, 2401ull), 2401ull);
    EXPECT_EQ(gcd(13841287201ull, 16807ull), 16807ull);
    EXPECT_EQ(gcd(13841287201ull, 117649ull), 117649ull);
    EXPECT_EQ(gcd(13841287201ull, 823543ull), 823543ull);
    EXPECT_EQ(gcd(13841287201ull, 5764801ull), 5764801ull);
    EXPECT_EQ(gcd(13841287201ull, 40353607ull), 40353607ull);
    EXPECT_EQ(gcd(13841287201ull, 282475249ull), 282475249ull);
    EXPECT_EQ(gcd(13841287201ull, 1977326743ull), 1977326743ull);
    EXPECT_EQ(gcd(13841287201ull, 13841287201ull), 13841287201ull);
    EXPECT_EQ(gcd(13841287201ull, 96889010407ull), 13841287201ull);
    EXPECT_EQ(gcd(13841287201ull, 678223072849ull), 13841287201ull);
    EXPECT_EQ(gcd(96889010407ull, 1ull), 1ull);
    EXPECT_EQ(gcd(96889010407ull, 7ull), 7ull);
    EXPECT_EQ(gcd(96889010407ull, 49ull), 49ull);
    EXPECT_EQ(gcd(96889010407ull, 343ull), 343ull);
    EXPECT_EQ(gcd(96889010407ull, 2401ull), 2401ull);
    EXPECT_EQ(gcd(96889010407ull, 16807ull), 16807ull);
    EXPECT_EQ(gcd(96889010407ull, 117649ull), 117649ull);
    EXPECT_EQ(gcd(96889010407ull, 823543ull), 823543ull);
    EXPECT_EQ(gcd(96889010407ull, 5764801ull), 5764801ull);
    EXPECT_EQ(gcd(96889010407ull, 40353607ull), 40353607ull);
    EXPECT_EQ(gcd(96889010407ull, 282475249ull), 282475249ull);
    EXPECT_EQ(gcd(96889010407ull, 1977326743ull), 1977326743ull);
    EXPECT_EQ(gcd(96889010407ull, 13841287201ull), 13841287201ull);
    EXPECT_EQ(gcd(96889010407ull, 96889010407ull), 96889010407ull);
    EXPECT_EQ(gcd(96889010407ull, 678223072849ull), 96889010407ull);
    EXPECT_EQ(gcd(678223072849ull, 1ull), 1ull);
    EXPECT_EQ(gcd(678223072849ull, 7ull), 7ull);
    EXPECT_EQ(gcd(678223072849ull, 49ull), 49ull);
    EXPECT_EQ(gcd(678223072849ull, 343ull), 343ull);
    EXPECT_EQ(gcd(678223072849ull, 2401ull), 2401ull);
    EXPECT_EQ(gcd(678223072849ull, 16807ull), 16807ull);
    EXPECT_EQ(gcd(678223072849ull, 117649ull), 117649ull);
    EXPECT_EQ(gcd(678223072849ull, 823543ull), 823543ull);
    EXPECT_EQ(gcd(678223072849ull, 5764801ull), 5764801ull);
    EXPECT_EQ(gcd(678223072849ull, 40353607ull), 40353607ull);
    EXPECT_EQ(gcd(678223072849ull, 282475249ull), 282475249ull);
    EXPECT_EQ(gcd(678223072849ull, 1977326743ull), 1977326743ull);
    EXPECT_EQ(gcd(678223072849ull, 13841287201ull), 13841287201ull);
    EXPECT_EQ(gcd(678223072849ull, 96889010407ull), 96889010407ull);
    EXPECT_EQ(gcd(678223072849ull, 678223072849ull), 678223072849ull);
}

TEST(Algorithms, primitiveRootModulo)
{
    Mt19937RandomGenerator<64> rnd{};
    EXPECT_EQ(primitiveRootModulo(2, rnd), 1);
    EXPECT_EQ(primitiveRootModulo(3, rnd), 2);
    EXPECT_EQ(primitiveRootModulo(4, rnd), 0);
    EXPECT_EQ(primitiveRootModulo(5, rnd), 2);
    EXPECT_EQ(primitiveRootModulo(6, rnd), 0);
    EXPECT_EQ(primitiveRootModulo(7, rnd), 3);
    EXPECT_EQ(primitiveRootModulo(9, rnd), 0);
    EXPECT_EQ(primitiveRootModulo(10, rnd), 0);
    EXPECT_EQ(primitiveRootModulo(11, rnd), 2);
}